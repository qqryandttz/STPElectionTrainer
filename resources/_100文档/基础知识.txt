基础知识

概念解释
STP（Spanning Tree Protocol）即生成树协议生成树协议，是一种网络通信协议，主要用于解决以太网网络中的环路问题。
STP通过建立一种无环路的树形网络结构，确保数据包在网络中能够高效、可靠地传输，避免由于环路导致的广播风暴、MAC地址表不稳定等问题。

学习意义
学习STP协议对于理解和构建稳定、可靠的以太网网络至关重要。
在复杂的网络环境中，冗余链路可以提高网络的容错性和可用性，但同时也可能引入环路问题。
STP协议正是为了解决这一问题而设计的，它能够在不改变网络物理拓扑的情况下，通过逻辑上的配置，实现无环路的网络结构，从而提高网络的性能和稳定性。


专有名词及其简称:

根桥 (Root Bridge)：STP生成树的最顶端交换设备，是STP生成树的“树根”。所有其他交换机都会根据与根桥的距离来确定它们在生成树中的位置。
指定端口 (Designated Port)：在STP中，每个网段上被选择为转发数据包的端口。指定端口负责将数据包转发到其他网段，并确保数据包在网络中沿最短路径传输。
阻塞端口 (Blocked Port)：在STP中，为了消除环路而被设置为不转发数据包的端口。阻塞端口不会参与数据包的转发过程，但仍会监听网络中的STP信息以维持生成树的稳定性。
优先级 (Priority)：在STP中，用于确定交换机成为根桥或指定端口的优先级。优先级较低的交换机更有可能成为根桥或指定端口。
路径开销 (Path Cost)：在STP中，用于衡量从一个交换机到根桥的路径上所有链路的总开销。路径开销较小的路径更有可能被选为生成树的路径。
根路径开销（Root Path Cost）：在STP中，根路径开销是指从一个交换机端口到根桥（Root Bridge）所经过的所有链路的累计开销。STP使用这种开销度量来决定数据包在网络中的转发路径。开销较低的路径会被选为生成树的优先路径。
BID (Bridge ID)：网桥标识符。这是STP中用于唯一标识一个交换机的标识符，由交换机的优先级和MAC地址组成。BID用于选举根桥和指定端口。
PID (Port ID)：端口标识符。这是STP中用于唯一标识交换机上某个端口的标识符，通常由端口的优先级和端口号组成。PID用于确定端口在生成树中的角色。

拓展:

广播风暴 (Broadcast Storm)：在网络中，由于某种原因（如环路）导致广播消息被无限循环转发，消耗大量网络资源，导致网络性能急剧下降的现象。
MAC地址表 (MAC Address Table)：在网络设备（如交换机）中，用于存储与端口相关联的MAC地址和端口映射关系的表。MAC地址表的不稳定可能导致网络流量错误地转发。
以太网 (Ethernet)：一种基于IEEE 802.3标准的局域网技术，广泛应用于各种网络环境中。
冗余链路 (Redundant Link)：在网络中，为了提高容错性和可用性而添加的额外链路。冗余链路可以在一条链路故障时提供备份路径，但同时也可能引入环路问题。
BPDU (Bridge Protocol Data Unit)：桥协议数据单元。这是STP协议中用于在交换机之间传递信息的特殊协议报文。BPDU分为配置BPDU（用于生成树的选举以及重收敛）和TCN BPDU（通知交换网络出现了拓扑变更）。
RSTP (Rapid Spanning Tree Protocol)：快速生成树协议。这是STP的一个改进版本，通过减少端口状态转换的时间来提高收敛速度。RSTP在IEEE 802.1W文档中定义。
MSTP (Multiple Spanning Tree Protocol)：多生成树协议。这是STP的另一个改进版本，允许在一个网络中支持多个VLAN的生成树。MSTP在IEEE 802.1S文档中定义。
收敛时间 (Convergence Time)：这是指STP在检测到网络拓扑变化后，重新计算生成树并将网络恢复到稳定状态所需的时间。收敛时间越短，网络恢复的速度越快。
转发延时 (Forward Delay)：STP协议中端口从阻塞状态（Blocked）到转发状态（Forwarding）所需的时间。在IEEE 802.1D中，转发延时默认为15秒。
Max Age：BPDU的最大存活时间。如果交换机在Max Age时间内没有收到来自上游交换机的BPDU，它将认为上游交换机已经失效，并开始重新计算生成树。在IEEE 802.1D中，Max Age默认为20秒。
Hello Time：BPDU的发送间隔。交换机按照Hello Time的间隔发送配置BPDU，以通知其他交换机自己的状态。在IEEE 802.1D中，Hello Time默认为2秒。
Max-Hop：在某些实现中，用于限制BPDU在网络中传递的最大跳数。这有助于防止BPDU在网络中无限循环传递。




路径开销值的计算方法(缺省情况下)

参数说明
dot1d-1998（IEEE 802.1d-1998标准方法）
	这个标准在较早期定义了路径开销的计算方法，但具体的开销值取决于链路的带宽。

dot1t（IEEE 802.1t标准方法）
	这是IEEE后续的标准，它同样基于链路的特性来计算路径开销，但具体的算法可能与dot1d-1998有所不同。

legacy（华为的私有计算方法）
	这是华为设备特有的路径开销计算方法。


本次教程采用dot1d-1998的开销计算方法，并且接口为全双工

FastEthernet0/0/1【快速以太网端口，100Mbit/s】 19
GigabitEthernet0/0/1【千兆以太网端口，1000Mbit/s】 4



说明
在本次教程中,主要是针对stp选举规则的练习,即交换机分别依据路径开销/根路径开销/优先级等元素,对根桥/根端口/指定端口的选举规则的练习,并不涉及到数据包(如BPDU/TCN等)的发送/命令行输入以及STP定时器和故障处理机制













